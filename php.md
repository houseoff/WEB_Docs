# **Заметки по разработке на PHP**

## **Введение**

---

Для запуска команд PHP используется след. тег:

    <?php
        ...code...;
    ?>

    <?php
        echo "Hello world";
    ?>

Используется два стиля написания кода PHP:

1. Открыть тег <?php ... ?> в начале документа и писать весь HTML код внутри данного тега
2. Использовать тег <?php ... ?> в тех местах в коде, где это необходимо

Также есть альтернативный вариант написания тега:

    <?
        ...code...;
    ?>

Данное написание тега не рекомендуется использовать, так как

1. Неочевиден вызов парсера PHP, что может сбить с толку
2. Несовместим с XML

Если в файле содержится только код PHP, то закрывающую часть тега PHP можно опустить. Это является хорошим тоном в PHP.

    <?php
        ...code...;

## **Комментарии**

---

Существует три способа добавления комментариев в код PHP

1.  Два слеша перед текстом

        // Это комментарий

2.  Символ "решетки" перед текстом

        # Это комментарий

3.  Многострочный комментарий

        <?php
            /*  Это область
                многострочного комментария,
                которая не будет
                подвергаться интерпретации
            */
        ?>

## **Основной синтаксис**

---

### **Точки с запятыми**

---

Все команды в PHP завершаются точкой с запятой

    <?php
        ...command...;
    ?>

Забывчивость завершить строку кода символом **;** является основной причиной возникновения ошибки **"Parse error"**

### **Символ $**

---

В PHP символ **$** должен ставиться перед именами всех переменных. Это нужно
для того, чтобы PHP-парсер работал быстрее, сразу же понимая, что имеет дело
с переменной

    <?php
        $mycounter = 1;
        $mystring = "Hello";
        $myarray = array("One", "Two", "Three");
    ?>

Отступы в PHP не играют никакой роли, как, например, в Python, однако, располагать код аккуратно приветствуется наряду с использованием комментариев. Это в разы повышает читаемость и восприятие кода

## **Переменные**

---

### **Строковые переменные**

---

Строковые переменные задаются с помощью двойных или одинарных кавычек

    <?php
        $username = "Houseoff";
        echo '$username';
        echo "$username";
    ?>

В двойных кавычках происходит интерпретация переменных, тегов HTML и т.п., в одинарных кавычках - нет

echo - это команда, выводящая содержимое переменной

### **Числовые переменные**

---

Целые числа задаются без кавычек, числа с плавающей точкой - через точку в качестве разделителя
целой и дробной части

    <?php
        $count = 17;
        $count_2 = 17.5;
    ?>

### **Массивы**

---

Массив создается с помощью функции array()

    <?php
        $arr = array(1, 2, '3');
    ?>

Массив может хранить данные разных типов (аналогия списка)

Обращение к элементам массива происходит по индексам

### **Двумерные массивы**

---

Создание двумерного массива:

    <?php
        $arr = array(
            array('x', ' ', 'o'),
            array('o', 'o', 'x'),
            array('x', 'o', ' ')
        );
    ?>

Для вывода данных из двумерного массива необходимо использовать след. конструкцию

    <?php
        echo $arr[0][1];
    ?>

### **Правила присваивания имен переменных**

---

Следует придерживаться следующих правил именования переменных:

- Имена переменных после знака доллара, должны начинаться с буквы или с символа **\_** (подчеркивания)
- Имена переменных могут содержать только символы: латинские буквы a-z и A-Z, 0-9 и \_ (подчеркивание)
- Имена перенных не должны включать в себя пробелы. Если имя переменной нужно составить более чем из одного слова, то в качестве разделителя рациональнее всего будет использовать символ подчеркивания (например, $user_name)
- Имена переменных чувствительны к регистру символов. Переменная $High_Score отличается от переменной $high_score

## **Операторы**

---

### **Арифметические операторы**

---

| Оператор | Описание                             | Пример    |
| :------: | :----------------------------------- | :-------- |
|    +     | Сложение                             | $j + 1    |
|    -     | Вычитание                            | $j - 6    |
|    \*    | Умножение                            | $j \* 11  |
|    /     | Деление                              | $j / 4    |
|    %     | Модуль (остаток от деления)          | $j % 9    |
|    ++    | Инкремент (приращение)               | ++$j      |
|    --    | Декремент (отрицательное приращение) | --$j      |
|   \*\*   | Возведение в степень                 | $j \*\* 2 |

### **Операторы присваивания**

---

| Оператор | Пример   | Эквивалент   |
| :------: | :------- | :----------- |
|    =     | $j = 15  | $j = 15      |
|    +=    | $j += 5  | $j = $j + 5  |
|    -=    | $j -= 3  | $j = $j - 3  |
|   \*=    | $j \*= 8 | $j = $j \* 8 |
|    /=    | $j /= 16 | $j = $j / 16 |
|    .=    | $j .= $k | $j = $j . $k |
|    %=    | $j %= 4  | $j = $j % 4  |

### **Операторы сравнения**

| Оператор | Описание         | Пример         |
| :------: | :--------------- | :------------- |
|    ==    | Равно            | $j == 4        |
|    !=    | Не равно         | $j != 21       |
|    >     | Больше           | $j > 3         |
|    <     | Меньше           | $j < 100       |
|    >=    | Больше или равно | $j >= 15       |
|    <=    | Меньше или равно | $j <= 8        |
|    <>    | Не равно         | $j <> 23       |
|   ===    | Тождественно     | $j === "987"   |
|   !==    | Не тождественно  | $j !== "1.2e3" |

### **Логические операторы**

---

| Оператор | Описание              | Пример              |
| :------: | :-------------------- | :------------------ |
|    &&    | И                     | $j == 3 && $k == 2  |
|   and    | Низкоприоритетное И   | $j == 3 and $k == 2 |
|   \|\|   | ИЛИ                   | $j < 5 \|\| $j > 10 |
|    or    | Низкоприоритетное ИЛИ | $j < 5 or $j > 10   |
|    !     | Не                    | ! ($j == $k)        |
|   xor    | Исключающее ИЛИ       | $j xor $k           |

Оператор **&&** взаимозаменяем с оператором **and**, оператор **||** взаимозаменяем с оператором **or**. Однако, операторы **&&** и **||** имеют более высокий приоритет выполнения, и рекомендуется использовать именно их.
Исключение составляют ситуации, когда необходимо, чтобы выполнилась вторая инструкция при неудачном завершении первой. Например, если выбор базы данных завершился неудачно, то необходимо сообщить об ошибке

    <?php
        mysql_select_db($db) or die("Не удалось выбрать базу данных");
    ?>

## **Присваивание значений переменным**

---

Примеры присваивания

    <?php
        $x = 10; // переменная = значение
        $y = $x; // переменная = значение другой переменной либо ссылка на объект
        $x += 10; // переменная = переменная + 10
        $x -= 10; // переменная = переменная - 10
    ?>

### **Увеличение и уменьшение значения переменной на единицу**

---

Вместо операторов **+=** и **-=** можно использовать операторы **++** и **--** соответственно

    <?php
        $x += 1;
        $x -= 1;
        ++$x;
        --$x;
        $x++;
        $x--;
    ?>

В чем разница между **--\$x** и **\$x--**? Рассмотрим следующий пример кода

    <?php
        $y = 9;
        if (++$y == 10) echo $y; // результат: 10
    ?>

Объявляется переменная $y, в которой хранится значение 9. Далее проверяется условие: если текущее значение переменной $y, увеличенное на единицу, равно 10, тогда необходимо вывести его на экран. В данном случае условие выполняется, и мы увидим число 10 на экране

Рассмотрим другой пример кода

    <?php
        $y = 9;
        if ($y++ == 10) echo $y; // результат: ничего
    ?>

На экране не будет никакого вывода, так как в условии сначала проверяется текущее значение переменной $y = 9, а только после этого это значение увеличивается на единицу

### **Объединение строк**

---

Конкатенация (объединение строк) - помещение одного содержимого после другого

    <?php
        $msg = 5;
        echo "У Вас " . $msg . " сообщений"; // У Вас 5 сообщений
    ?>

Также можно добавить одну строку к другой

    <?php
        $surname = " Smith";
        $name = "John";
        $name .= $surname;
        echo $name; // Результат: John Smith
    ?>

### **Типы строк**

---

Подробнее об отличии строк в одинарных кавычках и двойных кавычках.

В одинарные кавычки заключается строка, в которой все символы должны быть отображены как есть, без интерпретации

В двойных кавычках возможно вычисление переменных и спец. символы также будут "вычисляться"

    <?php
        $count = 5;
        $info = 'Внутри данной строки переменная $count не вычисляется';
        $info2 = "Внутри данной строки значение вычислится и будет равно $count";
    ?>

Вместо конкатенации можно пользоваться вычислением значений переменных внутри двойных кавычек

    <?php
        $count = 5;
        echo "У Вас " . $count . " сообщений";
        echo "У Вас $count сообщений";
    ?>

### **Изменение предназначения переменных**

---

Экранировние специальных символов осуществляется с помощью обратного слеша **\\**

    <?php
        $my_str = 'В тексте экранируются \'одинарные кавычки\'';
        $my_str2 = "В тексте экранируются \"двойные кавычки\"";
    ?>

В тексте с одинарными кавычками распознаётся только апостроф (**\\'**) и сам обратный слеш (**\\**).

В тексте с двойными кавычками можно использовать специальные символы табуляции, возврата каретки и т.п.

### **Многострочные команды**

---

Для вывода многострочного текста используются следующие способы:

1.  Заключение в кавычки несколько строк кода

        <?php
            $author = "John Smith"

            echo "Developers,
            developers, developers!

            $author.";
        ?>

2.  Присвоение многострочного значения переменной

        <?php
            $author = "John Smith"

            $text = "Developers,
            developers, developers!

            - $author";

            echo $text;
        ?>

3.  Многострочная последовательность.

    Многострочная последовательность объявляется с помощью оператора **<<<**, который называется **here-document** или **heredoc**. С помощью данного оператора в тексте сохраняются обрывы строк и т.п. После оператора **<<<** требуется указать тег, который будет говорить о том, что весь текст после тега должен быть строкой, заключенной в двойные кавычки. Например

        <?php
            $author = "John Smith";

            echo <<<_END
            dfhghffghfghf
             fghfghfhfhfh
              fhfhfhfhfhfhfhfhfh
               fhfhfhfsdrfwer
                gfdtg

            - $author.
            _END;
        ?>

    Важно запомнить, что закрывающий тег **\_END** должен появляться только перед началом строки и после конца строки. Внутри строки тег должен отсутствовать

    Также внутри heredoc-конструкции можно свободно пользоваться как одинарными так и двойными кавычками, однако, запрещается использовать специальные символы табуляции, возврата каретки и т.п.

    Многострочную последовательность можно присвоить переменной

        <?php
            $author = "John Smith";

            $text = <<<_END
            dfhghffghfghf
             fghfghfhfhfh
              fhfhfhfhfhfhfhfhfh
               fhfhfhfsdrfwer
                gfdtg

            - $author.
            _END;

            echo $text;
        ?>

    Вместо тега **\_END** можно использовать любой другой

    Важно также запомнить, что многострочное присваивание является лишь средством, упрощающем чтение кода в PHP. В HTML данная последовательность интерпретироваться как в PHP не будет

## **Типы переменных**

---

PHP относится к слаботипизированным языкам программирования

Например, можно создать число, состоящее из нескольких цифр, и извлечь из него n-ую цифру, просто предположив, что это число является строкой. Затем, умножив полученный результат функции substr() на число 5, получить результат умножения

    <?php
        // Объявляем переменную $number, которая является числом
        $number = 12345 * 67890;

        // Функция substr() принимает число $number как строку
        // В результате получаем "1" в виде строки
        echo substr($number, 3, 1);

        // Затем PHP неявно конвертирует строку "1" в число и умножает его на 5.
        // В результате получаем 5, которое уже является числом
        echo 5 * substr($number, 3, 1);
    ?>

## **Константы**

---

Константы - тип перенных, информация в которые заносится один раз, и эта информация не может быть изменена.
Пример объявления константы

    <?php
        define("ROOT_LOCATION", "usr/local/www/");
        echo ROOT_LOCATION;
    ?>

Константы объявляются только с помощью функции define(). При обращении к константе не нужно использовать символ **$**.

## **Предопределенные константы**

---

| Волшебная константа | Описание                                                               |
| :-----------------: | :--------------------------------------------------------------------- |
|    \_\_LINE\_\_     | Номер текущей строки в файле                                           |
|    \_\_FILE\_\_     | Полное путевое имя файла. Если используется внутри инструкции include, то возвращается имя включенного файла. В некоторых операционных системах допускается использование псевдонимов для каталогов, которые называются символическими ссылками; в \_\_FILE\_\_ они всегда заменяются реальными каталогами |
| \_\_DIR\_\_ | Каталог файла. Если используется внутри инструкции include, то возвращается каталог включенного файла. Такой же результат дает применение функции dirname(\_\_FILE\_\_). В этом имени каталога отсутствует замыкающий слеш, если только этот каталог не является корневым |
| \_\_FUNCTION\_\_ | Имя функции. Возвращает имя функции, под которым она была объявлена (с учетом регистра символов). В PHP 4 возвращаемое значение всегда составлено из символов нижнего регистра |
| \_\_CLASS\_\_ | Имя класса. Возвращает имя класса, под которым он был объявлен (с учетом регистра символов). В PHP 4 возвращаемое значение всегда составлено из символов нижнего регистра |
| \_\_METHOD\_\_ | Имя метода класса. Возвращает имя метода, под которым он был объявлен (с учетом регистра символов) |
| \_\_NAMESPACE\_\_ | Имя текущего пространства имен (с учетом регистра символов). Эта константа определена во время компиляции |

## **Различие между командами echo и print**
---
Отличия команды echo и print следующие:
1. Команда **echo** - в чистом виде конструкция языка PHP, а команда **print** - функция, которая возвращает значение 1
2. Команду **echo** нельзя использовать как часть сложного выражения. Например, код ниже возможен только при использовании функции **print**
    
        <?php
            $b ? print "TRUE" : print "FALSE";
        ?>

В данном примере кода используется тернарная конструкция if-else, в которой проверяется значение переменной $b. Если оно равно true, тогда функция **print** выведет на экран значение true, в противном случае - false

## **Функции**

## Работа с текстом. Поиск в тексте

---

Поиск позиции в тексте: функция strpos()

Функция принимает на вход строку, в которой искать и искомую подстроку

    <?php
        strpos("Hello World", "World"); // Результат = 6
        strpos("Hello World", "Bye"); // Результат = false
    ?>

Если подстрока найдена, то функция возвращает индекс первого вхождения подстроки.

Если подстрока не найдена, то функция возвращает false

## Работа с текстом. Изменение текста

---

Функция substr() находит подстроку, исходя из начальной позиции. Например

    <?php
        substr("Hello", 2); // Результат = "llo"
    ?>

Выводится подстрока, начиная с индекса 2 и до конца строки

## Работа с текстом. Обрезка и замена текста

---

Функция trim() удаляет пробелы в начале и конце строки
Функция ltrim() удаляет пробелы в начале строки
Функция rtrim() удаляет пробелы в конце строки

Функция str_replace() - замена подстроки в строке на другую подстроку
Данная функция принимает 3 аргумента:

1. подстрока, в которой осуществляется замена
2. подстрока для замены
3. основная строка

Например

    <?php
        str_replace("Goo", "Ba", "Good"); // Результат = "Bad"
    ?>

Если в строке не нашлось подстроки, в которой необходимо произвести замену, то функция возвращает оригинальную строку, переданную в третьем аргументе функции

## Переменная $\_REQUEST

---

Переменная $\_REQUEST является массивом.
К ней можно обращаться по индексам, либо по ключам, так как в PHP существует понятие "ассоциативный массив" (хэш-таблица)

    <?php
        $_REQUEST[0]; // Обращение по индексу
        $_REQUEST['name']; // Обращение по ключу
    ?>

Перебор значений массива осуществляется с помощью цикла foreach

    <?php
        foreach ($_REQUEST as $value) {
            echo "<p>" . $value . "</p>";
        }
    ?>

Можно так же перебрать все ключи и значения

    <?php
        foreach ($_REQUEST as $key => $value) {
            echo "<p> Для " . $key . "имеется значение" . $value . "</p>";
        }
    ?>

## Работа с текстом. Регулярные выражения

---

Рассмотрим пример кода

    <?php
        $string_to_search = "Martin OMC-28LJ";
        $regex = "/OM/";
        $sum_mathes = preg_match($regex, $string_to_search);
    ?>

Функция preg_match принимает на вход, в данном случае, два аргумента.
